<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Billing Test</title>
<style>
body{font-family:Arial;background:#f2f2f2}
.box{width:400px;margin:50px auto;background:#fff;padding:20px;border-radius:8px}
label{display:block;margin-top:10px}
input{width:100%;padding:6px}
.msg{margin-top:10px;font-size:14px}
.ok{color:green}
.no{color:red}
</style>
</head>

<body>

<div class="box">
<h3>Billing â€“ Customer Fetch Test</h3>

<label>Mobile Number</label>
<input id="mobile">

<label>Customer Name</label>
<input id="cname">

<label>Address</label>
<input id="caddr">

<button onclick="fetchCustomer()">Fetch Customer</button>

<div id="msg" class="msg"></div>

<hr>

<button onclick="window.print()">Print</button>
<button onclick="sendWA()">WhatsApp</button>
</div>

<script>
const API = "https://script.google.com/macros/s/AKfycbzgjTvvG9kJxl294NT-rQONzNwZL-aHcO8Ygicg3ylZdnmI6bZ8qs-LzYF4gkAb7MiRDg/exec";

function fetchCustomer(){
  const m = mobile.value.trim();
  if(m.length !== 10){
    msg.innerHTML = "Enter 10-digit mobile";
    msg.className = "msg no";
    return;
  }

  fetch(API + "?action=getCustomer&mobile=" + m)
    .then(r => r.json())
    .then(d => {
      console.log("API RESPONSE:", d); // ðŸ”´ IMPORTANT

      if(d.found){
        cname.value = d.name;
        caddr.value = d.address;
        msg.innerHTML = "Customer fetched successfully";
        msg.className = "msg ok";
      } else {
        cname.value = "";
        caddr.value = "";
        msg.innerHTML = "Customer not found (new customer)";
        msg.className = "msg no";
      }
    })
    .catch(err=>{
      msg.innerHTML = "Fetch error";
      msg.className = "msg no";
      console.error(err);
    });
}

function sendWA(){
  const text =
`SVLN SOLUTIONS
Customer: ${cname.value}
Mobile: ${mobile.value}
Address: ${caddr.value}`;
  window.open("https://wa.me/91"+mobile.value+"?text="+encodeURIComponent(text));
}
</script>

</body>
</html>
