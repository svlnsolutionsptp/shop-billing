<!DOCTYPE html>
<html>
<head>
<title>SVLN SOLUTIONS - Tax Invoice</title>

<style>
body{font-family:Arial;background:#f0f0f0;}
.bill{
  width:210mm;
  margin:auto;
  background:#fff;
  padding:20px;
  border:1px solid #000;
}

.header{text-align:center;}
.header h2{margin:2px 0;}
.header p{margin:2px;font-size:13px;}

.info-table, .item-table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}

.info-table td{
  border:1px solid #000;
  padding:6px;
  font-size:14px;
}

.item-table th, .item-table td{
  border:1px solid #000;
  padding:6px;
  text-align:center;
}

.item-table th{
  background:#e0e0e0;
}

input,select{
  width:100%;
  padding:4px;
  font-size:14px;
}

.no-print{}
.print-text{display:none;}

.footer{
  text-align:center;
  margin-top:20px;
  font-weight:bold;
  font-size:14px;
}

button{padding:8px 14px;margin:5px;}

@media print{
  input,select,button,.no-print{display:none!important;}
  .print-text{display:inline!important;}
  body{background:#fff;}
}
</style>
</head>

<body>

<div class="bill">

<!-- HEADER -->
<div class="header">
  <h2>SVLN SOLUTIONS</h2>
  <p>5-33, Gold Market Street, Pithapuram</p>
  <p>Andhra Pradesh ‚Äì 533450</p>
  <p>üìû 9533330347, 9494488885</p>
  <h3>Tax Invoice</h3>
</div>

<!-- BILL INFO -->
<table class="info-table">
<tr>
  <td><b>Bill No:</b> <span id="billno" class="print-text"></span></td>
  <td><b>Date:</b> <span id="bdate"></span></td>
</tr>
<tr>
  <td>
    <b>Customer Name:</b>
    <span id="pcname" class="print-text"></span>
    <input id="cname" class="no-print">
  </td>
  <td>
    <b>Mobile:</b>
    <span id="pmobile" class="print-text"></span>
    <input id="mobile" class="no-print">
  </td>
</tr>
</table>

<!-- ITEM ENTRY -->
<table class="item-table no-print">
<tr>
  <th>Item</th><th>Qty</th><th>Price</th><th>Amount</th><th></th>
</tr>
<tr>
  <td><select id="item"></select></td>
  <td><input id="qty" type="number" value="1"></td>
  <td><input id="price"></td>
  <td id="amt">0</td>
  <td><button onclick="addItem()">Add</button></td>
</tr>
</table>

<!-- BILL ITEMS -->
<table class="item-table" id="billTable">
<tr>
  <th>S.No</th>
  <th>Description</th>
  <th>Qty</th>
  <th>Rate</th>
  <th>Amount</th>
</tr>
</table>

<!-- TOTAL -->
<table class="info-table" style="width:40%;float:right;margin-top:10px;">
<tr><td>Total</td><td id="total">0</td></tr>
<tr><td>GST (18%)</td><td id="gst">0</td></tr>
<tr><td><b>Grand Total</b></td><td id="grand">0</td></tr>
</table>

<p><b>Amount in Words:</b> <span id="words"></span></p>

<div style="clear:both"></div>

<!-- BUTTONS -->
<button class="no-print" onclick="saveBill()">Generate Bill</button>
<button class="no-print" onclick="window.print()">Print</button>

<!-- FOOTER -->
<div class="footer">
  Thank You ‚Äì Visit Again üôè
</div>

</div>

<script>
/* CONFIG */
const API = "https://script.google.com/macros/s/AKfycbwpbLtM6zx961KO8OD2N6RCe_kFxKH6vcL3bVelxv70QnzBz1YNzdCcgGAyMRpV8wGHWg/exec";

/* INIT */
bdate.innerText = new Date().toLocaleDateString();
let billItems=[], total=0, sno=1;

/* LOAD PRODUCTS */
fetch(API+"?action=products")
.then(r=>r.json())
.then(d=>{
 d.forEach(p=>{
  let o=document.createElement("option");
  o.value=p[0];
  o.text=p[1];
  o.dataset.price=p[3];
  item.appendChild(o);
 });
 price.value=item.options[0].dataset.price;
 calcAmt();
});

/* CALC */
function calcAmt(){
 amt.innerText=(qty.value*price.value).toFixed(2);
}
qty.oninput=calcAmt;
price.oninput=calcAmt;
item.onchange=()=>{price.value=item.options[item.selectedIndex].dataset.price;calcAmt();}

/* ADD ITEM */
function addItem(){
 let q=Number(qty.value), p=Number(price.value);
 if(q<=0||p<=0){alert("Invalid qty/price");return;}
 let a=q*p;

 billItems.push({code:item.value,qty:q});
 total+=a;

 let r=billTable.insertRow();
 r.insertCell(0).innerText=sno++;
 r.insertCell(1).innerText=item.options[item.selectedIndex].text;
 r.insertCell(2).innerText=q;
 r.insertCell(3).innerText=p.toFixed(2);
 r.insertCell(4).innerText=a.toFixed(2);

 calcTotal();
}

/* TOTAL */
function calcTotal(){
 let gstAmt = total * 0.18;
 totalEl.innerText = total.toFixed(2);
 gst.innerText = gstAmt.toFixed(2);
 grand.innerText = (total + gstAmt).toFixed(2);
 words.innerText = numWords(Math.round(total + gstAmt));
}

function numWords(n){
 const a=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten",
 "Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"];
 const b=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];
 if(n<20)return a[n]+" Rupees Only";
 if(n<100)return b[Math.floor(n/10)]+" "+a[n%10]+" Rupees Only";
 if(n<1000)return a[Math.floor(n/100)]+" Hundred "+numWords(n%100);
 return numWords(Math.floor(n/1000))+" Thousand "+numWords(n%1000);
}

/* SAVE BILL */
function saveBill(){
 if(!cname.value || mobile.value.length<10){
  alert("Customer details required"); return;
 }
 if(billItems.length==0){
  alert("Add items"); return;
 }

 pcname.innerText=cname.value;
 pmobile.innerText=mobile.value;

 fetch(API+"?action=sell"+
 "&items="+encodeURIComponent(JSON.stringify(billItems))+
 "&cname="+encod

